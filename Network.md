# Network
* 두 대 이상의 컴퓨터(장치)가 연결된 상태

## 네트워크 기초 명령어
1. 네트워크 인터페이스 보는 명령어
* ipconfig
    - /all : MAC 주소 등 세부정보 확인
    - /release : ip 주소를 해제해서 네트워크 연결을 끊을 때
    - /renew : ip주소를 새롭게 갱신해서 네트워크 재연결
* ifconfig
* ip a s

###  NIC, 네트워크 인터페이스 카드 

2. netstat : 사용중인 port 정보 확인
    - a : 전체정보 표시
    - n : 포트정보를 번호를 표시
    - b : 프로세스 정보 표시

3. nslookup : dns 조회

4. ping : 상대방 호스트의 상태를 확인하기 위한 명령어
    - ICMP 프로토콜 사용한다.

5. tracert, traceroute : 네트워크 경로를 확인하기 위하여 사용함

6. arp : address resolution protocol
    - arp -a : arp 테이블(arp 캐시) 정보를 볼 수 있음

7. route print : 라우팅 테이블 정보
    - netstat -nr
* 메트릭 : 비용, 낮은 것을 선택
* rip, osrf, eigrp 자동으로 라우팅 경로를 세팅

8. hostname : 호스트 이름 확인

9. net user : 사용자 계정정보 확인

---
1비트 = 최소 단위
8비트 = 1바이트 = 처리 최소 단위

앞의 24비트는 OUI(제조사 고유정보)
뒤의 24비트는 각 NIC의 고유번호(HOST ID)

### 게이트웨이
* 서로 다른 프로토콜을 사용하는 네트워크끼리 통신할 수 있게 만듦

### 라우터
* 라우팅(최적의 경로 찾기)해주는 장비

---
### 동축 케이블
* 비쌈
* 무거윰
* 절연체가 두거움
    - 멀리까지 간섭 없이 연결 가능 

=================================
* 베이스 밴드
    - 디지털 신호 전송(LAN)
    - 변조하지 않음
    - 수백 미터(근거리 전송)
    - 양방향 통신
* 브로드 밴드
    - 아날로그 신호 전송(CATV)
    - 수십 킬로(장거리 전송)
    - 다중 채널(음성, 영상 등 따로 보냄)
    - 단방향 통신

=================================
### 네트둬크 패킷을 받는 경우
1. 유니캐스트인데 수신지가 나인 경우
2. 브로드캐스트 -> FF:FF:FF:FF:FF:FF , 255.255.255.255 
3. 멀티캐스트인데 내가 수신지에 적혀있는 멀티 캐스트 그굽에 속한 경우

* 패킷을 버리는 이유
    -  메모리와 CPU를 아끼기 위해

---
## 이더넷
* 2계층 통신 프로토콜
* Preamble 
    - 이더넷 헤더에 포함되지 않음
    - 이더넷 신호가 전송됨을 알림
```
10101010 * 7 + 10101011
10101011(SFD) : Start of Frame Delimeter)
```
* Destination Addresess : 도착지 MAC 주소 (6바이트)
* Source Addres : 출발지 MAC 주소 (6바이트)
* ethernet type : 상위 프로토콜 종류 (2바이트)
    - 0x0800 : IP
    - 0x0806 : ARP
* FCS : Frame Check Sequence : 오류 체크 값 (4byte)

이더넷 헤더의 길이 : 14바이트
이더넷 데이터의 길이  : 46바이트 ~ 1500바이트
이더넷 프레임의 최고 크기 : 1514(1518)

#### 라우터를 지날때 마다 목적지, 출발지 MAC주소도 바뀜

==================================
* wireshark
    - 패킷 캡처 프로그램
    - GUI 환경으로 패킷 분석


---
## 무선 네트워크

### IEEE 802.11 표준 규격
* 802.11ax(wifi6)    10GHz

---
## port
* 동일한 IP 주소를 가진 시스템 내에서 프로세스를 구분하기 위한 주소
    - 0 ~ 65535번 주소 사용, 16빈트 주소
    - 0 ~ 1023  : System Port(Well-known Port)
        + 잘 알려진 서비스들이 사용
    - 1024 ~ 49151 : User Port(Registerd Port)
        + 응용 프로그램들이 사용
    - 49152 ~ 56535 : Dynamic Port
        + 접속을 하는 용도로 사용

---
### 많이 알려진 서비스의 Port번호
* FTP : 20, 21 (File Transfer Protocol)  
* SSH : 22 (원격 접속, 암호화)  
* telnet : 23 (원격 접속, 비암호화)  
* SMTP : 25 (Simple Mail Transfer Protocol)  
* DNS : 53      UDP, TCP
* TFTP(Trivial FTP) : 69    UDP  
    - 스위치, 라우터 펨웨어 업데이트  
    - 간단한 자료 전송  
* HTTP : 80 (평문 전송)
* HTTPS(SSL) : 443 (암호화 통신)
* pop3 : 110
* Netbios : 137 ~ 139 137 138   UDP, TCP
    - 윈도우 시스템 이름 관련 서비스
* SMB : 445 (파일 공유 프로토콜)

==========  
DBMS  
* MS-SQL : 1433, 1434  
* MY-SQL(MariaDB) : 3306  
* ORACLE : 1521  

* 원격 데스크톱 : 3389  

* SNMP : 161, 162
    - TCP/IP 기반 네트워크상의 각 호스트로부터 정기적으로 여러 관리 정보를 자동으로 수집하거나 실시간으로 상태를 모니터링 및 설정할 수 있는 서비스
* DHCP : 67

---
### 서비스 목목 확인
* windows\system32\drivers\etc\services
* /etc/services

---
## 와이어 샤크 사용법

### 화면 구성
* 패킷 리스트
* 패킷 디테일
* 패킷 바이트

### 패킷 검색 방법
```
ip.arr ==
ip.dst ==
ip.src ==

tcp.port == 80
udp.port == 80
tcp.dstport == 80
tcp.srcport == 80

|| : or
&& : and
```
실습 : 평문통신 http 프로토콜을 스니핑하기
* Promiscueous

---
## osi7 계층
참조 : https://shlee0882.tistory.com/110

* 7계층 - 응용 계층(Application Layer)
* 6계층 - 표현 계층(Presentation Layer)
    - 암호화, 복호화, 압축, 인코딩
    - 데이터 가공
* 5계층 -세션 계층(Session Layer)
    - 세션 연결, 유지, 해제
* 4계층 - 전송 계층(Transport Layer) 
    - 5계층과 4계층 사이에서 '포트' 연결/할당
    - 오류 복구, 흐름 제어 등 담당
* 3계층 - 네트워크 계층(Network Layer)
    - IP
* 2계층 - 데이터 링크계층(DataLink Layer)
* 1계층 - 물리계층(Physical Layer)

### PDU
* 프로토콕 전송 단위
    - 전송계정 : 세그먼트
    - 네트워크 : 패킷
    - 데이터 링크 : 프레임
* DPI(deep packet inspection)
    - 패킷을 깊게 분석함

---
## 네트워크 장비
* hub
    - Flooding
    - Collision(충돌)
* Swithc L2
    - Collision domain(충돌이  일어나는 범위)
    - Learning : 스위치의 MAC Address Table에 각 포트에 해당하는 MAC Address를 학습
    - Forwarding : 목적지를 앎
        + MAC Address Table을 참고하여 전송할 패킷이 전달되어야 할 포트로만 전송
    - Filtering : 목적지 이외에는 안 보냄
        + MAC Address Table을 참고하여 전송될 필요가 없는 포트로는 전송을 하지 않음
    - Flooding : 목적지를 모름
        + 목적지 MAC Address를 모르는 패킷은 전체 포트로 전달, 그외 브로드 캐스트 패킷도 전체 포트로 전달
    - Aging : MAC Table 캐싱 시간(300초)
        + 약 300초 정도 MAC Address Table 유지 : 300초 내 갱신이 없을 경우 MAC Address Table 삭제, 갱신이 있을 경우 시간 연장
        + 리소스를 아낌, 장비 변경 가능성

* Router, L3 Swithch
* L4 Switch
* L7 Switch

#### 브로드캐스트 도메인 : 브로드캐스트 범위

---
## IP
* IP 주소 체계
    - IP 주소는 Network ID와 Host ID로 구분된다.
* Network ID가 같다는 것은 같은 네트워크에 속한다.
* 클래스 : IP주소를 효율적으로 배정하기 위한 개념

A클래스 : 0.0.0.0 ~ 127.255.255.255
B클래스 : 128.0.0.0 ~ 191.255.255.255
C클래스 : 192.0.0.0 ~ 223.255.255.255 
D클래스 : 224.0.0.0 ~ 239.255.255.255
E클래스 : 240.0.0.0 ~ 255.255.255.255

### 서브넷  마스크
    - 서브넷팅하는데 사용하는 수단, 해당 네트워크의 Network ID와 Host ID 구

============================     
#### A클래스의 넷마스크
* 255.0.0.0

#### A클래스 네트워크 개수
* 128개
    - 다만 0과 127로 시작하는 네트워크는 제외
    - 나눠줄 수 있는 네트워크 개수는 126개

#### A클래스 호스트 개수
* 256 * 256 * 256 = 16777216개
    - 전체 IP갯수에서 2개를 빼야함
    - 16777214 개
* 가장 맨 처음 호스트 주소
    - 호스트 주소가 모두 0인 주소, 네드워크 주소
* 가장 맨 끝 호스트 주소
    - 호스트주소가 모두 1인 주소, 브로드 캐스트 주소

네트워크 주소 : 하나의 네트워크를 통칭하는 주소(대표자)
브로드캐스트 주소 : 특정 네트워크에 속하는 모든 호스트들이 듣게되는 주소(모두)

--------------------------------------------------------------
### 서브넷마스크 예시
```
192.168.0.10  둘다 서브넷마스크 255.255.255.128
192.168.0.148

이 두개의 ip는 같은 네트워크에 속하는가? 다름

대상 ip에 서브넷마스크를 bit 연산하여 네트워크 id 가 같으면 같은 네트워크

11000000.10101000.00000000.00001010  192.168.0.10

11111111.11111111.11111111.11111100  255.255.255.255

11000000.10101000.00000000.00000000   and 연산

-----------------------------------------------------------------------
11000000.10101000.00000000.10010100    192.168.0.148

11111111.11111111.11111111.10000000  255.255.255.128

11000000.10101000.00000000.10000000   and 연산
```
============================     
#### B클래스의 넷마스크
* 255.255.0.0

#### B클래스 네트워크 개수
* 2^14 = 16384개

#### B클래스 호스트 개수
* 2^16 = 65536개 - 2개 = 65534개

퀴즈 : 150.20.0.0 ~ 150.20.255.255

         네트워크 주소 :  150.20.0.0
         브로드캐스트 주소 : 150.20.255.255

실제 사용가능한 주소 범위 : 150.20.0.1 ~ 150.20.255.254

============================     
#### C클래스의 넷마스크
* 255.255.255.0

#### C클래스 네트워크 개수
* 2^21 =2097152개

#### C클래스 호스트 개수
* 256개 - 2 = 254개

예 : 192.168.0.0 ~ 192.168.0.255

네트워크 주소 : 192.168.0.0
브로드캐스트주소 : 192.168.0.255
실제 사용가능한 ip 주소 : 192.168.0.1~ 192.168.0.254

============================     
#### D클래스
* 멀티 캐스트 주소로 씀

============================
#### E클래스
* 예약용

---
### 서브넷팅


## 각 프로토콜 분석(IP, TCP, ARP, ICMP, UDP, ...)
