# 15 Hands-On ML(Scikit-Learn, Keras, TensorFlow)

## 머신러닝을 왜 쓰는가?
* 전통적인 프로그래밍?
    - 문제 발생 -> 문제 해결??? 어떻게? -> 규칙작성
    - 규칙(알고리즘) 작성???? - > 소프트웨어 작성
        + 규칙 확인 -> 문제 발생 -> 문제 해결(알고리즘 수정) -> 확인 (반복)
* 머신 러닝은?
    - 문제 -> 문제 해결?? 어떻게??
    - 모델(알고리즘)을 만듦 -> 문제를 유발하는 데이터들 -> 모델을 학습(fit)시킨다.
        + 모델 확인(예측) -> 문제 발생 -> 문제해결(모델을 다시 학습시킴) -> 확인 (반복)
		
## 대표적인 머신러닝 어플리케이션
* 이미지
    - CNN(Convolutional Neural Network)
        + 합산곱 연산
        + 데이터들의 특징을 추출해 특징들의 패턴을 파악하는 구조
* 자연어 처리, 음성인식
    - RNN(Recurrent Neural Networks)
* 게임
    - 강화 학습
        - 심리학적 요소들
* 예술
    - GAN(Generative Adversarial Network)
        + deepfake 찾아내기
        + 데이터의 차이를 보정
* 분류
    - 군집알고리즘
        + 악성코드 분류/찾기

## 머신러닝의 종류
* 훈련 방법 : 지도(정답이 있음), 비지도(정답 레이블이 없음), 준지도(일부분의 정답만 있음), 강화(보상)
* 훈련 시점
    - 온라인 : 실시간 데이터 업데이트
    - 배치 : 이미 가지고 있는(준비된) 데이터로 학습
* 모델 생성
    - 사례 : 샘플을 기억함
    - 모델 : 샘플을 사용해 모델을 학습시킴

### 지도 학습
* 훈련 데이터에는 '레이블'이라는 원하는 답이 필요함
* 회귀 : 연속된 값(output)을 예측함
    - 선형 회귀
    - 로지스틱 회귀
* 분류
    - SVM
    - DT, 앙상블
* 신경망
    - 만능
    - CNN
    - RNN
    - GAN
    - GPT-3 : 자연어 처리 모델(범용)
	
### 비지도 학습
* 정답은 없음
    - 차이점을 찾아 분류함(군집화 함)
    - 시각화와 차원 축소
    - 연관 규칙 학습

* k - m
* PCA
* 가우시안

## 모델 기반 학습
* 모델을 만들어 예측함
* 간단한 선형 모델
	- 삶의 만족도 = b + a * (1인당_GDP)
	- 2개의 __모델 파라미터__ b와 a를 가짐
	- 모델 파라미터는 '피처'라고도 불림?

* 효용함수 or  적합도 함수 : 모델이 얼마나 좋은지 측정
* 비용함수 : 모델이 얼마나 나쁜지 측정
	- 얼마나 좋은지는 끝없이 값이 늘어나기 때문에, 0에 수렴할 수 있는 '비용함수'를 많이 쓴다.
	
### 선형 데이터
* Linear
    - 선형식
    - 1차 : W1X1 = b , X1 = b / W1
    - 2차 : W1X1 + W2X2 = b , X1 = (b - W2X2) / W1
    - 3차 : W1X1 + W2X2 + W3X3 = b
* 회귀 : 연속되는 값을 예측
* 선을 그리기 위해
    - 기울기 : a
    - 절편 : b
    - 삶의 만족도 = b + a * (GDP)
    - y = ax + b
	
## 정리
* 데이터 선택/분석
* 모델 객체 생성(선택)
* 모델 훈련
* 데이터 예측

---
## 머신러닝의 주요 과제
* 데이터가 충분하지 않음
    - 데이터가 많아야 학습이 잘된다
    - 학습이 잘 되면 성능이 좋은 알고리듬 탄생
* 데이터에 대표성이 없을 수 있다.
    - 샘플링 잡음 : 작은 샘플로 인한, 우연에 의한 대표성이 없는 데이터
    - 샘플링 편향 : 매우 큰 샘플이라도 추출 방법이 잘못되어 대표성이 없을 수 있음
* 낮은 품질의 데이터, 관련 없는 특성
* 과대 적합
	- 예측이 95%만 넘어도 overfitting일 확률이 높다
    - 훈련 세트에 너무 특화되어 있음 -문제점-> 실제 예측이 낮아진자.
    - Ex) 나는 모의고사만 판다 -> 수능망함
    - 해결방안은???
        + 규제를 사용(참고: p59)
		+ 하이퍼피라미터(규제하기 위해사용하는 값)를 사용 
* 과소 적합 발생
    - 모델이 너무 학습이 안 되어있다.
    - 특징을 못 찾음
    - Ex) 주가 예측 -> 1/2 확률
        + 사람 40%, 침팬치 60%
		
## 학습이 잘되는 기준?
* lost function OR loss function
* loss function -> 평균 -> cost

## 훈련 셋과 테스트 셋분류
* 테스트 셋을 구하기 힘들기 때문에 분류해서 학습을 시킴
* 데이터를 뽑아 분포를 확인(시각화), 데이터셋이 훈련셋과 같은지 확인(예측을 잘 하는지 확인)
* 학습전 훈련 셋과 테스트 셋으로 구분 한다.
    - 테스트 셋으로 미리 분석하면 안된다.
    - 테스트 셋으로 학습 -> 전체모델의 결과에 영향을 준다. (수능을 봐야 하는데 수능까지 학습함)
    - 테스크 셋의 크기 보통 20%, 
    - 데이터가 많아(5만개 이상). 1만개
* 훈련셋과 테스트셋을 구분할땐 어떻게 추출해야 할까?랜덤
    -  np.random
    - 컴퓨터는 랜덤이 가능할까???? - No
    - np.random.sedd(42) : seed를 지정하면 난수 발생의 초기값을 지정할 수 있다.

### 셋분류할 때, 사용하는 lib
* 넘파이모듈 사용 x
* 식별자 분류 x
* sklearn.model_selection.train_test_split(random_state=42) O

### 계층적 샘플링
* 요소를 고려하고 대상을 선택함
* 데이터 편향을 막음
    - 계층 기준
        + 소득, 나이, 성별
    - 범주를 지정하고 각 범주별로 샘플을 뽑아 낸다.
        + 학습과정의 평향을 막을 수 있음
        + 해당 계층이 제외되는 것을 막을 수 있음
```
Ex) 소득
1억 ~ 8000 : 80:20
8000 ~ 5000 : 80:20
5000 ~ 2000 : 80:20
2000 ~ 0 : 80:20
```

# 선형 모델 정리
* fit
	- 선형 모델에 학습을 시키면, 데이터 셋을 가지고 '기울기'과 '절편'을 자동으로 설정해주는 것
	- 이게 모델을 만들었다는 의미
	
# 모델 만들기 전에하는 과정
1. 문제 정의
	- 비지니스의 목적이 정확히 무엇인가?
	- 모델로 무엇을할려고 하는가?
	- 현재 솔루션(문제 해결 방법)은 무엇인가?
	- 현재의 솔루션보다 모델을 만들어 해결하는가 더 나은가?
	- 모델을 만들기 위해 어떤 방식을 사용할 것인가?
		+ 훈련 방법 : 지도, 비지도, 준지도, 강화
		+ 훈련 시점 : 온라인, 배치
		
2. 성능 지표 선택
	- 회귀 문제
	 	+ 평균 제곱근 오차(RMSE)
	 	+ 평균 절대 오차(MAE) : 이상치가 많으면 고려가능

3. 가정 검사
	- '분류'가 아니라 '회귀'를 사용하는게 맞는지 다시 확인